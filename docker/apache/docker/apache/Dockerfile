FROM php:7.4-apache 
#Задаёт образ.
#RUN выполняет команду и создаёт слой образа. Используется для установки в контейнер пакетов.
RUN a2enmod rewrite 
#Подключение модулей
RUN a2enmod headers
RUN a2enmod expires

RUN service apache2 restart
#перезапусr Apache

RUN mkdir /var/www/work
RUN chown www-data:www-data /var/www/work

RUN mkdir /var/www/site1
RUN chown www-data:www-data /var/www/site1

RUN mkdir /var/www/protected
RUN chown www-data:www-data /var/www/protected

RUN mkdir /var/www/protected2
RUN chown www-data:www-data /var/www/protected2

RUN groupadd --gid=1000 dev && useradd -u 1000 -N -G www-data --gid=1000 -s /bin/bash -m dev
#Это необходимо из-за того, что некоторые функции отказываются запускаться от имени пользователя root. Кроме того, полезно не запускать функции от имени пользователя root, даже в контейнере.

#LABEL — описывает метаданные. Например — сведения о том, кто создал и поддерживает образ.
#ENV — устанавливает постоянные переменные среды.
#RUN — выполняет команду и создаёт слой образа. Используется для установки в контейнер пакетов.
#COPY — копирует в контейнер файлы и папки.
#ADD — копирует файлы и папки в контейнер, может распаковывать локальные .tar-файлы.
#CMD — описывает команду с аргументами, которую нужно выполнить когда контейнер будет запущен. Аргументы могут быть переопределены при запуске контейнера. В файле может присутствовать лишь одна инструкция CMD.
#WORKDIR — задаёт рабочую директорию для следующей инструкции.
#ARG — задаёт переменные для передачи Docker во время сборки образа.
#ENTRYPOINT — предоставляет команду с аргументами для вызова во время выполнения контейнера. Аргументы не переопределяются.
#EXPOSE — указывает на необходимость открыть порт.
#VOLUME — создаёт точку монтирования для работы с постоянным хранилищем.
